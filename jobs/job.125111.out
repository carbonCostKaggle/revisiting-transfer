
loading Tensorflow

loading scikit-learn

The following have been reloaded with a version change:
  1) CUDA/11.0.2-GCC-9.3.0 => CUDA/11.1.1-GCC-10.2.0
  2) CUDAcore/11.0.2 => CUDAcore/11.1.1
  3) Check/0.15.2-GCCcore-9.3.0 => Check/0.15.2-GCCcore-10.2.0
  4) FFTW/3.3.8-gompic-2020a => FFTW/3.3.8-gompic-2020b
  5) GCC/9.3.0 => GCC/10.2.0
  6) GCCcore/9.3.0 => GCCcore/10.2.0
  7) GDRCopy/2.1-GCCcore-9.3.0-CUDA-11.0.2 => GDRCopy/2.1-GCCcore-10.2.0-CUDA-11.1.1
  8) GMP/6.2.0-GCCcore-9.3.0 => GMP/6.2.0-GCCcore-10.2.0
  9) OpenBLAS/0.3.9-GCC-9.3.0 => OpenBLAS/0.3.12-GCC-10.2.0
 10) OpenMPI/4.0.3-gcccuda-2020a => OpenMPI/4.0.5-gcccuda-2020b
 11) PMIx/3.1.5-GCCcore-9.3.0 => PMIx/3.1.5-GCCcore-10.2.0
 12) Python/3.8.2-GCCcore-9.3.0 => Python/3.8.6-GCCcore-10.2.0
 13) SQLite/3.31.1-GCCcore-9.3.0 => SQLite/3.33.0-GCCcore-10.2.0
 14) ScaLAPACK/2.1.0-gompic-2020a => ScaLAPACK/2.1.0-gompic-2020b
 15) SciPy-bundle/2020.03-fosscuda-2020a-Python-3.8.2 => SciPy-bundle/2020.11-fosscuda-2020b
 16) Tcl/8.6.10-GCCcore-9.3.0 => Tcl/8.6.10-GCCcore-10.2.0
 17) UCX/1.8.0-GCCcore-9.3.0-CUDA-11.0.2 => UCX/1.9.0-GCCcore-10.2.0-CUDA-11.1.1
 18) XZ/5.2.5-GCCcore-9.3.0 => XZ/5.2.5-GCCcore-10.2.0
 19) binutils/2.34-GCCcore-9.3.0 => binutils/2.35-GCCcore-10.2.0
 20) bzip2/1.0.8-GCCcore-9.3.0 => bzip2/1.0.8-GCCcore-10.2.0
 21) fosscuda/2020a => fosscuda/2020b
 22) gcccuda/2020a => gcccuda/2020b
 23) gompic/2020a => gompic/2020b
 24) hwloc/2.2.0-GCCcore-9.3.0 => hwloc/2.2.0-GCCcore-10.2.0
 25) libevent/2.1.11-GCCcore-9.3.0 => libevent/2.1.12-GCCcore-10.2.0
 26) libfabric/1.11.0-GCCcore-9.3.0 => libfabric/1.11.0-GCCcore-10.2.0
 27) libffi/3.3-GCCcore-9.3.0 => libffi/3.3-GCCcore-10.2.0
 28) libpciaccess/0.16-GCCcore-9.3.0 => libpciaccess/0.16-GCCcore-10.2.0
 29) libreadline/8.0-GCCcore-9.3.0 => libreadline/8.0-GCCcore-10.2.0
 30) libxml2/2.9.10-GCCcore-9.3.0 => libxml2/2.9.10-GCCcore-10.2.0
 31) ncurses/6.2-GCCcore-9.3.0 => ncurses/6.2-GCCcore-10.2.0
 32) numactl/2.0.13-GCCcore-9.3.0 => numactl/2.0.13-GCCcore-10.2.0
 33) pybind11/2.4.3-GCCcore-9.3.0-Python-3.8.2 => pybind11/2.6.0-GCCcore-10.2.0
 34) zlib/1.2.11-GCCcore-9.3.0 => zlib/1.2.11-GCCcore-10.2.0

base

Install requirements, check pandas version
Defaulting to user installation because normal site-packages is not writeable
Collecting cuda-python
  Downloading cuda_python-12.1.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.6 MB)
Collecting tensorboardX
  Using cached tensorboardX-2.6-py2.py3-none-any.whl (114 kB)
Requirement already satisfied: psutil in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from -r requirements.txt (line 3)) (5.7.2)
Collecting opencv-python
  Using cached opencv_python-4.7.0.72-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (61.8 MB)
Collecting Pillow
  Downloading Pillow-9.5.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.3 MB)
Collecting matplotlib
  Downloading matplotlib-3.7.1-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (9.2 MB)
Collecting carbontracker
  Using cached carbontracker-1.1.7-py3-none-any.whl (32 kB)
Collecting pandas>=2.0.0
  Downloading pandas-2.0.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.3 MB)
Requirement already satisfied: cython in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from cuda-python->-r requirements.txt (line 1)) (0.29.21)
Requirement already satisfied: packaging in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from tensorboardX->-r requirements.txt (line 2)) (20.4)
Requirement already satisfied: numpy in /opt/itu/easybuild/software/SciPy-bundle/2020.11-fosscuda-2020b/lib/python3.8/site-packages (from tensorboardX->-r requirements.txt (line 2)) (1.19.4)
Requirement already satisfied: protobuf<4,>=3.8.0 in /opt/itu/easybuild/software/protobuf-python/3.13.0-fosscuda-2020a-Python-3.8.2/lib/python3.8/site-packages (from tensorboardX->-r requirements.txt (line 2)) (3.13.0)
Collecting cycler>=0.10
  Using cached cycler-0.11.0-py3-none-any.whl (6.4 kB)
Requirement already satisfied: pyparsing>=2.3.1 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 6)) (2.4.7)
Collecting importlib-resources>=3.2.0; python_version < "3.10"
  Using cached importlib_resources-5.12.0-py3-none-any.whl (36 kB)
Collecting contourpy>=1.0.1
  Downloading contourpy-1.0.7-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (300 kB)
Collecting fonttools>=4.22.0
  Downloading fonttools-4.39.3-py3-none-any.whl (1.0 MB)
Requirement already satisfied: python-dateutil>=2.7 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from matplotlib->-r requirements.txt (line 6)) (2.8.1)
Collecting kiwisolver>=1.0.1
  Downloading kiwisolver-1.4.4-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl (1.2 MB)
Collecting geocoder
  Using cached geocoder-1.38.1-py2.py3-none-any.whl (98 kB)
Requirement already satisfied: requests in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from carbontracker->-r requirements.txt (line 7)) (2.24.0)
Collecting pynvml
  Using cached pynvml-11.5.0-py3-none-any.whl (53 kB)
Requirement already satisfied: importlib-metadata in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from carbontracker->-r requirements.txt (line 7)) (2.0.0)
Collecting tzdata>=2022.1
  Downloading tzdata-2023.3-py2.py3-none-any.whl (341 kB)
Requirement already satisfied: pytz>=2020.1 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from pandas>=2.0.0->-r requirements.txt (line 8)) (2020.1)
Requirement already satisfied: six in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from packaging->tensorboardX->-r requirements.txt (line 2)) (1.15.0)
Requirement already satisfied: setuptools in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from protobuf<4,>=3.8.0->tensorboardX->-r requirements.txt (line 2)) (50.3.0)
Requirement already satisfied: zipp>=3.1.0; python_version < "3.10" in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from importlib-resources>=3.2.0; python_version < "3.10"->matplotlib->-r requirements.txt (line 6)) (3.3.0)
Requirement already satisfied: future in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from geocoder->carbontracker->-r requirements.txt (line 7)) (0.18.2)
Requirement already satisfied: click in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from geocoder->carbontracker->-r requirements.txt (line 7)) (7.1.2)
Collecting ratelim
  Using cached ratelim-0.1.6-py2.py3-none-any.whl (4.0 kB)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests->carbontracker->-r requirements.txt (line 7)) (1.25.10)
Requirement already satisfied: chardet<4,>=3.0.2 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests->carbontracker->-r requirements.txt (line 7)) (3.0.4)
Requirement already satisfied: idna<3,>=2.5 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests->carbontracker->-r requirements.txt (line 7)) (2.10)
Requirement already satisfied: certifi>=2017.4.17 in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from requests->carbontracker->-r requirements.txt (line 7)) (2020.6.20)
Requirement already satisfied: decorator in /opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/lib/python3.8/site-packages (from ratelim->geocoder->carbontracker->-r requirements.txt (line 7)) (4.4.2)
Installing collected packages: cuda-python, tensorboardX, opencv-python, Pillow, cycler, importlib-resources, contourpy, fonttools, kiwisolver, matplotlib, ratelim, geocoder, pynvml, tzdata, pandas, carbontracker
ERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts.

We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default.

pandas 2.0.0 requires numpy>=1.20.3; python_version < "3.10", but you'll have numpy 1.19.4 which is incompatible.
pandas 2.0.0 requires python-dateutil>=2.8.2, but you'll have python-dateutil 2.8.1 which is incompatible.
matplotlib 3.7.1 requires numpy>=1.20, but you'll have numpy 1.19.4 which is incompatible.
Successfully installed Pillow-9.5.0 carbontracker-1.1.7 contourpy-1.0.7 cuda-python-12.1.0 cycler-0.11.0 fonttools-4.39.3 geocoder-1.38.1 importlib-resources-5.12.0 kiwisolver-1.4.4 matplotlib-3.7.1 opencv-python-4.7.0.72 pandas-2.0.0 pynvml-11.5.0 ratelim-0.1.6 tensorboardX-2.6 tzdata-2023.3
WARNING: You are using pip version 20.2.3; however, version 23.1 is available.
You should consider upgrading via the '/opt/itu/easybuild/software/Python/3.8.6-GCCcore-10.2.0/bin/python3 -m pip install --upgrade pip' command.
Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done


==> WARNING: A newer version of conda exists. <==
  current version: 4.10.1
  latest version: 23.3.1

Please update conda by running

    $ conda update -n base -c defaults conda



# All requested packages already installed.

Pandas version: 1.1.4

Making mammograms dataframe
2023-04-21 09:47:15.837964: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
Index(['patient_id', 'breast density', 'left or right breast', 'image view',
       'abnormality id', 'abnormality type', 'calc type', 'calc distribution',
       'assessment', 'pathology', 'subtlety', 'image file path',
       'cropped image file path', 'ROI mask file path', 'breast_density',
       'mass shape', 'mass margins'],
      dtype='object')
BENIGN       2111
MALIGNANT    1457
Name: class, dtype: int64
train: 2854
val: 714
train: 2854
val: 714
train: 2854
val: 714
train: 2855
val: 713
train: 2855
val: 713
